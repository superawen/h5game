window.__require=function t(e,i,r){function o(n,h){if(!i[n]){if(!e[n]){var a=n.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!h&&l)return l(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+n+"'")}n=a}var c=i[n]={exports:{}};e[n][0].call(c.exports,function(t){return o(e[n][1][t]||t)},c,c.exports,t,e,i,r)}return i[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<r.length;n++)o(r[n]);return o}({Astar:[function(t,e){"use strict";cc._RF.push(e,"54830LeZDRPAp8oCvx5kwlZ","Astar");var i=cc.Class({ctor:function(){this.parent=null,this.tiledCoord=null,this.f=0,this.g=0,this.h=0},getF:function(){return this.g+this.h}});cc.Class({extends:cc.Component,properties:{tiledMap:{default:null,type:cc.TiledMap},tiledLogicLayer:{default:null,type:cc.TiledLayer},openList:{visible:!1,default:null},closeList:{visible:!1,default:null}},findWay:function(t,e){var r=this.gl2tiledPositon(e),o=this.gl2tiledPositon(t);if(!this._isBarrier(r)&&!r.equals(o)){this.openList=[],this.closeList=[];var s=new i;s.tiledCoord=o,this._insertToOpenList(s);do{var n=this.openList[0];if(this.closeList.push(n),this.openList.shift(),n.tiledCoord.equals(r)){var h=this._createPath(n);return this.openList.splice(0,this.openList.length),this.closeList.splice(0,this.closeList.length),h}for(var a=this._getNeighbouringNodes(n),l=0;l<a.length;l++){var c=new i;if(c.tiledCoord=a[l],!this._isArrayContainAstarNode(this.closeList,c)){var d=this._countCurTile2NeighbourTileCost(s,c);c.parent=n,c.g=n.g+d,c.h=this._countCostToDestWithManhattan(c.tiledCoord,r);var u=this._indexNodeInArray(this.openList,c);if(-1===u)this._insertToOpenList(c);else{var p=this.openList[u];c.g<p.g&&(this.openList.splice(u,1),this._insertToOpenList(c))}}}}while(this.openList.length>0);return null}},_createPath:function(t){var e=[];do{e.push(t.tiledCoord),t=t.parent}while(null!=t.parent);return e.reverse(),e},_countCostToDestWithManhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},_countCurTile2NeighbourTileCost:function(t,e){var i=10;return t.tiledCoord.x!==e.tiledCoord.x&&t.y!==e.tiledCoord.y&&(i=14),i},_insertToOpenList:function(t){for(var e=0;e<this.openList.length;e++){var i=this.openList[e];if(t.getF()<i.getF())break}this.openList.splice(e,0,t)},_isArrayContainAstarNode:function(t,e){for(var i=!1,r=0;r<t.length;r++)if(t[r].tiledCoord.equals(e.tiledCoord)){i=!0;break}return i},_indexNodeInArray:function(t,e){for(var i=-1,r=0;r<e.length;r++)if(e[r].tiledCoord.equals(t.tiledCoord)){i=r;break}return i},_getNeighbouringNodes:function(t){var e=[],i=t.tiledCoord.sub(cc.v2(0,1));this._isValidTileCoord(i)&&!this._isBarrier(i)&&e.push(i);var r=t.tiledCoord.add(cc.v2(0,1));this._isValidTileCoord(r)&&!this._isBarrier(r)&&e.push(r);var o=t.tiledCoord.sub(cc.v2(1,0));this._isValidTileCoord(o)&&!this._isBarrier(o)&&e.push(o);var s=t.tiledCoord.add(cc.v2(1,0));return this._isValidTileCoord(s)&&!this._isBarrier(s)&&e.push(s),e},_isBarrier:function(t){var e=this.tiledLogicLayer.getTileGIDAt(t);if(e){var i=this.tiledMap.getPropertiesForGID(e);if(i&&i.isBarrier)return!0}return!1},_isValidTileCoord:function(t){var e=!0,i=this.tiledMap.getMapSize();return(t.x<0||t.y<0||t.x>=i.width||t.y>=i.height)&&(e=!1),e},gl2tiledPositon:function(t){var e=this.tiledMap.getTileSize(),i=this.tiledMap.getMapSize(),r=Math.floor(t.x/e.width),o=Math.floor((i.height*e.height-t.y)/e.height);return r=r<i.width?r:i.width-1,o=o<i.height?o:i.height-1,cc.v2(r,o)},tile2glPosition:function(t){var e=this.tiledMap.getTileSize(),i=this.tiledMap.getMapSize(),r=t.x*e.width+e.width/2,o=i.height*e.height-t.y*e.height-e.height/2;return cc.v2(r,o)}}),cc._RF.pop()},{}],Game:[function(t,e){"use strict";cc._RF.push(e,"022a1IfAg5HbK8sLH2yDUDM","Game"),cc.Class({extends:cc.Component,properties:{tiledMap:{default:null,type:cc.TiledMap},playerFrame:{default:null,type:cc.SpriteFrame}},onLoad:function(){cc.debug.setDisplayStats(!1);var t=this.tiledMap.node.getContentSize(),e=this.tiledMap.getObjectGroup("sprite").getObject("pos");this.player=new cc.Node("player"),this.player.addComponent(cc.Sprite).spriteFrame=this.playerFrame,this.tiledMap.node.addChild(this.player),this.player.x=e.x-t.width/2,this.player.y=e.y-t.height/2,this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this)},onTouchStart:function(t){var e=this.node.getComponent("Astar"),i=this.tiledMap.node.convertToWorldSpaceAR(this.player.position);this.path=e.findWay(i,t.getLocation())},_movePlayerWithPath:function(){if(this.path&&this.path.length>0){var t=this.node.getComponent("Astar"),e=this.path.shift();e=this.tiledMap.node.convertToNodeSpaceAR(t.tile2glPosition(e)),this.player.runAction(cc.moveTo(.2,e))}else this.unschedule(this._movePlayerWithPath)},onTouchEnd:function(){this.schedule(this._movePlayerWithPath,.2)}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"3c301KC/RBOnpEVpNyBq2ub","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["Astar","Game","use_v2.0.x_cc.Toggle_event"]);