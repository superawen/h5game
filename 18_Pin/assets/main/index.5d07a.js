window.__require=function n(e,t,i){function s(p,c){if(!t[p]){if(!e[p]){var a=p.split("/");if(a=a[a.length-1],!e[a]){var d="function"==typeof __require&&__require;if(!c&&d)return d(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+p+"'")}p=a}var u=t[p]={exports:{}};e[p][0].call(u.exports,function(n){return s(e[p][1][n]||n)},u,u.exports,n,e,t,i)}return t[p].exports}for(var o="function"==typeof __require&&__require,p=0;p<i.length;p++)s(i[p]);return s}({ConstData:[function(n,e){"use strict";cc._RF.push(e,"14638K9xV1Mg4d0HwW7hmJE","ConstData"),cc.Class({statics:{ZIndex:{POP_BASE:1,TIP:999,POP_MASK:-999},LevelsData:[{donutType:0,donutPin:2,pinType:0,pin:3,speed:1.5},{donutType:0,donutPin:2,pinType:0,pin:4,speed:1.5},{donutType:0,donutPin:2,pinType:0,pin:5,speed:1.5},{donutType:0,donutPin:2,pinType:0,pin:6,speed:1.5},{donutType:0,donutPin:2,pinType:0,pin:7,speed:1.5},{donutType:0,donutPin:3,pinType:0,pin:5,speed:1.5},{donutType:0,donutPin:3,pinType:0,pin:6,speed:1.5},{donutType:0,donutPin:3,pinType:0,pin:7,speed:1.5},{donutType:0,donutPin:3,pinType:0,pin:8,speed:1.5},{donutType:0,donutPin:3,pinType:0,pin:9,speed:1.5},{donutType:1,donutPin:4,pinType:0,pin:10,speed:2},{donutType:1,donutPin:4,pinType:0,pin:12,speed:2},{donutType:1,donutPin:4,pinType:0,pin:14,speed:2},{donutType:1,donutPin:4,pinType:0,pin:16,speed:2},{donutType:1,donutPin:4,pinType:0,pin:18,speed:2},{donutType:1,donutPin:5,pinType:0,pin:20,speed:2},{donutType:1,donutPin:5,pinType:0,pin:22,speed:2},{donutType:1,donutPin:5,pinType:0,pin:24,speed:2},{donutType:1,donutPin:5,pinType:0,pin:26,speed:2},{donutType:1,donutPin:5,pinType:0,pin:28,speed:2},{donutType:2,donutPin:5,pinType:0,pin:30,speed:2.5},{donutType:2,donutPin:5,pinType:0,pin:32,speed:2.5},{donutType:2,donutPin:5,pinType:0,pin:34,speed:2.5},{donutType:2,donutPin:5,pinType:0,pin:36,speed:2.5},{donutType:2,donutPin:5,pinType:0,pin:38,speed:2.5},{donutType:2,donutPin:3,pinType:1,pin:12,speed:2.5},{donutType:2,donutPin:3,pinType:1,pin:13,speed:2.5},{donutType:2,donutPin:3,pinType:1,pin:15,speed:2.5},{donutType:2,donutPin:3,pinType:1,pin:15,speed:2.5},{donutType:2,donutPin:3,pinType:1,pin:15,speed:2.5},{donutType:3,donutPin:3,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:3,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:3,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:3,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:3,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:4,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:4,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:4,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:4,pinType:1,pin:15,speed:2.8},{donutType:3,donutPin:4,pinType:1,pin:15,speed:2.8},{donutType:4,donutPin:4,pinType:1,pin:15,speed:3},{donutType:4,donutPin:4,pinType:1,pin:15,speed:3},{donutType:4,donutPin:4,pinType:1,pin:15,speed:3},{donutType:4,donutPin:5,pinType:1,pin:16,speed:3},{donutType:4,donutPin:5,pinType:1,pin:16,speed:3},{donutType:4,donutPin:5,pinType:1,pin:16,speed:3},{donutType:4,donutPin:5,pinType:1,pin:16,speed:3},{donutType:4,donutPin:5,pinType:1,pin:18,speed:3},{donutType:4,donutPin:5,pinType:1,pin:18,speed:3},{donutType:4,donutPin:5,pinType:1,pin:20,speed:3}]}}),cc._RF.pop()},{}],Director:[function(n,e){"use strict";cc._RF.push(e,"a2a55RhwyZHfo0GMcF0EnW3","Director"),cc.Class({extends:cc.Component,statics:{scene:null,sceneCanvas:null,sceneComponent:null,init:function(){this.scene=null,this.sceneCanvas=null,this.sceneComponent=null,this.uiRoot=null},loadScene:function(n,e,t){window[this.sceneName+"Scene"]=null,cc.director.loadScene(n,function(){this.scene=cc.director.getScene(),this.sceneCanvas=this.scene.getChildByName("Canvas"),this.uiRoot=this.sceneCanvas.getChildByName("UIRoot")||this.sceneCanvas,this.sceneComponent=this.sceneCanvas.getComponent(n+"Scene"),this.sceneComponent&&(this.sceneComponent.sceneName=n+"Scene",this.sceneComponent.init&&this.sceneComponent.init(e)),window[n+"Scene"]=this.sceneComponent,t&&t(this.scene,this.sceneCanvas,this.sceneComponent)}.bind(this))},getUiRoot:function(){return this.uiRoot}}}),cc._RF.pop()},{}],Donut:[function(n,e){"use strict";cc._RF.push(e,"e4bbfmsly9Oqpp+V6HYurzl","Donut"),cc.Class({extends:cc.Component,properties:{fragments:[cc.Node]},playShatterAnimation:function(){var n,e;6==this.fragments.length?(n=[-80,-50,0,30,50,30],e=[450,430,430,430,430,450]):(n=[-80,-50,0,50,30],e=[450,430,430,430,450]);for(var t=0;t<this.fragments.length;t++){var i=this.fragments[t].getPosition(),s=[cc.v2(i.x,i.y),cc.v2(i.x+n[t],i.y+e[t]),cc.v2(i.x+n[t],i.y-1e3)],o=cc.bezierTo(1.2,s);this.fragments[t].runAction(o)}}}),cc._RF.pop()},{}],GameScene:[function(n,e){"use strict";function t(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=i(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var s=0;return function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(n,e){if(n){if("string"==typeof n)return s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(n,e):void 0}}function s(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}cc._RF.push(e,"96793wKagVG8LHTdsirugZ2","GameScene"),cc.Class({extends:cc.Component,properties:{prefabDonuts:[cc.Prefab],prefabPin:[cc.Prefab],ballPanel:cc.Node,bigBall:cc.Node,labelLevel:cc.Label,labelCount:cc.Label,nodeDonut:cc.Node,nodeReady:cc.Node},init:function(){this.isDebug=!1,this.smallBalls=[],this.tmpBalls=[],this.donutBalls=[],this.rotateSpeed=0,this.rotateDir=-1,this.pinIndex=0,this.pinCount=0,this.isRunning=!1,this.isPass=!1,this.curLevel=Number(cc.sys.localStorage.getItem("18_level")),this.isDebug&&(this.curLevel=24),this.loadLevel()},loadLevel:function(){var n=this,e=pin.constData.LevelsData[this.curLevel];this.rotateDir=Math.random()<.5?1:-1,this.rotateSpeed=e.speed,this.pinIndex=e.pinType,this.pinCount=e.pin,this.labelLevel.string="\u7b2c "+(this.curLevel+1)+" \u5173",this.labelCount.string=this.pinCount,this.nodeDonut.removeAllChildren();var i=cc.instantiate(this.prefabDonuts[e.donutType]);i.parent=this.nodeDonut,this.donutJs=i.getComponent("Donut");for(var s,o=t(this.tmpBalls);!(s=o()).done;)s.value.destroy();this.tmpBalls.splice(0);for(var p,c=t(this.smallBalls);!(p=c()).done;)p.value.destroy();this.smallBalls.splice(0);for(var a=0;a<e.pin;a++){var d=cc.instantiate(this.prefabPin[this.pinIndex]);d.active=a+1>=e.pin,d.getComponent("Pin").init(!1),d.parent=this.ballPanel,this.smallBalls.push(d)}for(var u,r=t(this.donutBalls);!(u=r()).done;)u.value.destroy();this.donutBalls.splice(0),this.bigBall.destroyAllChildren();for(var l=this.bigBall.width/2-2,h=360/e.donutPin,y=0;y<e.donutPin;y++){var T=cc.instantiate(this.prefabPin[this.pinIndex]),g=cc.misc.degreesToRadians(y*h);T.x=l*Math.sin(g),T.y=l*Math.cos(g),T.parent=this.bigBall,T.angle=180-y*h,T.getComponent("Pin").init(!this.isDebug),this.donutBalls.push(T)}this.nodeReady.getComponent(cc.Animation).play(),this.scheduleOnce(function(){n.isRunning=!0,n.isPass=!1},.1)},start:function(){var n=this;cc.director.getCollisionManager().enabled=!0,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),pin.event.on("gameover",function(){n.isRunning&&(n.isRunning=!1,pin.tip.show("\u6e38\u620f\u5931\u8d25\uff0c\u5373\u5c06\u91cd\u65b0\u5f00\u59cb"),n.scheduleOnce(function(){n.loadLevel()},2))},this)},onTouchStart:function(){var n=this;if(this.isRunning&&!this.isPass&&this.pinCount>0){this.pinCount--,this.labelCount.string=this.pinCount;var e=this.smallBalls.shift(),t=e.parent.convertToWorldSpaceAR(e.getPosition()),i=cc.instantiate(this.prefabPin[this.pinIndex]);i.parent=this.bigBall.parent,i.position=this.bigBall.parent.convertToNodeSpaceAR(t),this.tmpBalls.push(i),e.destroy();var s=this.bigBall.height/2-2,o=cc.v2(0,this.bigBall.y-s);i.runAction(cc.sequence(cc.moveTo(.05,o).easing(cc.easeSineOut()),cc.callFunc(function(){n.tmpBalls.shift(),i.parent=n.bigBall;var e=n.bigBall.angle;e=e%360+180,i.getComponent("Pin").init(!n.isDebug);var t=cc.misc.degreesToRadians(e);i.x=s*Math.sin(t),i.y=s*Math.cos(t),i.angle=180-e,n.donutBalls.push(i),n.scheduleOnce(n._checkPass.bind(n),0)})))}},_checkPass:function(){if(0==this.isPass&&0==this.pinCount){this.isPass=!0;var n=pin.constData.LevelsData.length-1;this.curLevel<n?(this.curLevel+=1,pin.tip.show("\u606d\u559c\u8fc7\u5173\uff0c\u5373\u5c06\u8fdb\u5165\u4e0b\u4e00\u5173")):pin.tip.show("\u606d\u559c\u4f60\u901a\u5173\u4e86"),cc.sys.localStorage.setItem("18_level",this.curLevel)}},lateUpdate:function(){var n=this;if(this.isRunning&&(this.nodeDonut.angle+=this.rotateDir*this.rotateSpeed,this.bigBall.angle=this.nodeDonut.angle,this.isPass&&Math.abs(this.bigBall.angle%360)<=10*this.rotateSpeed)){this.isRunning=!1,this.isPass=!1,this.nodeDonut.angle=0,this.bigBall.angle=0,this.donutJs.playShatterAnimation();for(var e,i=t(this.donutBalls);!(e=i()).done;){var s=e.value,o=s.getPosition();s.runAction(cc.moveTo(1,o.x,o.y-1e3).easing(cc.easeElasticIn(.7)))}this.scheduleOnce(function(){n.loadLevel()},2)}}}),cc._RF.pop()},{}],MainScene:[function(n,e){"use strict";cc._RF.push(e,"be329An/tdHbbITHsY2sOVj","MainScene"),window.pin=window.pin||{},cc.Class({extends:cc.Component,onLoad:function(){pin.event=new cc.EventTarget,pin.constData=n("./ConstData"),pin.tip=n("./Tip"),pin.director=n("./Director"),pin.director.init(),cc.debug.setDisplayStats(!1)},onClickBtnStart:function(){pin.director.loadScene("Game")}}),cc._RF.pop()},{"./ConstData":"ConstData","./Director":"Director","./Tip":"Tip"}],Pin:[function(n,e){"use strict";cc._RF.push(e,"0e337k95MBBVJcVpgygqIJF","Pin"),cc.Class({extends:cc.Component,properties:{},init:function(n){this._isCheck=n},onCollisionEnter:function(n,e){this._isCheck&&(n.node.stopAllActions(),e.node.stopAllActions(),pin.event.emit("gameover"))}}),cc._RF.pop()},{}],Tip:[function(n,e){"use strict";cc._RF.push(e,"6fc55rUrPFDxLyLc2cpq/Zh","Tip"),cc.Class({extends:cc.Component,properties:{tipLabel:cc.Label,tipBg:cc.Node},statics:{tipNode:null,show:function(n){cc.resources.load("prefabs/Tip",cc.Prefab,function(e,t){e||(cc.isValid(this.tipNode)&&this.tipNode.destroy(),this.tipNode=cc.instantiate(t),this.tipNode.zIndex=pin.constData.ZIndex.TIP,this.tipNode.parent=pin.director.getUiRoot(),this.tipNode.getComponent("Tip").init(n))}.bind(this))}},onLoad:function(){this.originalWidth=this.tipBg.width,this.originalHeight=this.tipBg.height,this.tipBg.opacity=0,this.tipLabel.string=""},init:function(n){this.text=n,this.node.y=0,this.tipLabel.string=this.text,this.tipLabel.node.height>this.originalHeight&&(this.tipBg.height=this.tipLabel.node.height+50);var e=cc.sequence(cc.spawn(cc.moveBy(.25,cc.v2(0,100)),cc.fadeIn(.25)),cc.delayTime(1.25),cc.spawn(cc.moveBy(.25,cc.v2(0,100)),cc.fadeOut(.25)),cc.callFunc(function(){this.node.destroy()}.bind(this)));this.tipBg.runAction(e)}}),cc._RF.pop()},{}],use_reversed_rotateTo:[function(n,e){"use strict";cc._RF.push(e,"edc19zlf9hFQK4JIb8D3jSH","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}]},{},["use_reversed_rotateTo","ConstData","Director","Donut","GameScene","MainScene","Pin","Tip"]);